services:
  metabase:
    container_name: marketing_warehouse_metabase
    build:
      context: .
      dockerfile: Dockerfile
      args:
        METABASE_VERSION: ${METABASE_VERSION:-0.52.9}
        METABASE_DUCKDB_DRIVER_VERSION: ${METABASE_DUCKDB_DRIVER_VERSION:-0.3.1}
    ports:
      - "${METABASE_PORT:-3000}:3000"
    environment:
      MB_DB_FILE: /metabase-data/metabase.db
      MB_PLUGINS_DIR: /plugins
      JAVA_TIMEZONE: UTC
    volumes:
      - metabase_data:/metabase-data
      - ../${DUCKDB_FILE:-warehouse.duckdb}:/data/warehouse.duckdb
    restart: unless-stopped

volumes:
  metabase_data:
